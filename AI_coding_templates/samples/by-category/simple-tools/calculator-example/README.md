# 数学计算器插件示例

这是一个简单工具类插件的完整示例，实现了基础的数学计算功能。

## 功能特点

- 支持基础数学运算（加减乘除）
- 支持高级数学函数（三角函数、对数、幂运算等）
- 表达式解析和计算
- 完善的错误处理
- 详细的计算历史记录

## 支持的运算

### 基础运算
- 加法：`2 + 3`
- 减法：`5 - 2`
- 乘法：`4 * 6`
- 除法：`10 / 2`
- 幂运算：`2 ^ 3` 或 `pow(2, 3)`

### 高级函数
- 三角函数：`sin(30)`, `cos(45)`, `tan(60)`
- 对数函数：`log(10)`, `ln(2.718)`
- 开方：`sqrt(16)`, `cbrt(27)`
- 绝对值：`abs(-5)`
- 取整：`floor(3.7)`, `ceil(3.2)`, `round(3.5)`

### 常数
- 圆周率：`pi` 或 `PI`
- 自然常数：`e` 或 `E`

## 使用示例

```typescript
// 基础计算
await tool({ expression: "2 + 3 * 4" });
// 结果: { result: "14", metadata: {...} }

// 高级函数
await tool({ expression: "sin(30) + cos(60)" });
// 结果: { result: "1", metadata: {...} }

// 复杂表达式
await tool({ expression: "sqrt(pow(3, 2) + pow(4, 2))" });
// 结果: { result: "5", metadata: {...} }
```

## 文件结构

```
calculator-example/
├── README.md          # 本文档
├── config.ts          # 插件配置
├── index.ts           # 导出入口
├── package.json       # 依赖管理
├── src/
│   ├── index.ts       # 核心实现
│   ├── calculator.ts  # 计算器逻辑
│   └── parser.ts      # 表达式解析
└── test/
    └── index.test.ts  # 测试用例
```

## 开发要点

1. **表达式解析**：使用安全的表达式解析器，避免eval()
2. **错误处理**：处理除零、无效函数等错误情况
3. **精度控制**：处理浮点数精度问题
4. **安全性**：防止恶意表达式注入
5. **性能优化**：缓存常用计算结果
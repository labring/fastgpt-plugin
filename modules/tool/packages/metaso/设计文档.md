# Metaso æ’ä»¶è®¾è®¡æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

### æ’ä»¶åç§°
**Metaso å·¥å…·é›†** - åŸºäº Metaso API çš„å¤šåŠŸèƒ½æœç´¢å’Œé—®ç­”å·¥å…·é›†

### åŠŸèƒ½æè¿°
æä¾›ä¸‰ç§æ ¸å¿ƒåŠŸèƒ½ï¼š
1. **æœç´¢ (Search)** - ç½‘é¡µå†…å®¹æœç´¢ï¼Œæ”¯æŒæ‘˜è¦ç”Ÿæˆ
2. **é—®ç­” (Ask)** - æ™ºèƒ½é—®ç­”æœåŠ¡
3. **ç½‘é¡µè¯»å– (Reader)** - æŒ‡å®šURLå†…å®¹æå–å’Œè§£æ

### æŠ€æœ¯æ¶æ„
é‡‡ç”¨ **Children ToolSet** æ¶æ„ï¼Œå°†ä¸‰ä¸ªåŠŸèƒ½ä½œä¸ºç‹¬ç«‹çš„å­å·¥å…·ç»„ç»‡åœ¨ä¸€ä¸ªå·¥å…·é›†ä¸­ã€‚

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### 1. é¡¹ç›®ç»“æ„
```
metaso/
â”œâ”€â”€ config.ts                    # å·¥å…·é›†ä¸»é…ç½®
â”œâ”€â”€ index.ts                     # å¯¼å‡ºå…¥å£
â”œâ”€â”€ logo.svg                     # å·¥å…·é›†å›¾æ ‡
â”œâ”€â”€ package.json                 # åŒ…é…ç½®
â”œâ”€â”€ shared/                      # å…±äº«æ¨¡å—
â”‚   â”œâ”€â”€ api.ts                  # Metaso API å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ config.ts               # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ types.ts                # é€šç”¨ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ utils.ts                # å·¥å…·å‡½æ•°
â”œâ”€â”€ children/                    # å­å·¥å…·ç›®å½•
â”‚   â”œâ”€â”€ search/                 # æœç´¢å·¥å…·
â”‚   â”‚   â”œâ”€â”€ config.ts          # æœç´¢å·¥å…·é…ç½®
â”‚   â”‚   â”œâ”€â”€ index.ts           # æœç´¢å·¥å…·å¯¼å‡º
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ index.ts       # æœç´¢æ ¸å¿ƒå®ç°
â”‚   â”‚       â””â”€â”€ types.ts       # æœç´¢ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ ask/                   # é—®ç­”å·¥å…·
â”‚   â”‚   â”œâ”€â”€ config.ts          # é—®ç­”å·¥å…·é…ç½®
â”‚   â”‚   â”œâ”€â”€ index.ts           # é—®ç­”å·¥å…·å¯¼å‡º
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ index.ts       # é—®ç­”æ ¸å¿ƒå®ç°
â”‚   â”‚       â””â”€â”€ types.ts       # é—®ç­”ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ reader/                # ç½‘é¡µè¯»å–å·¥å…·
â”‚       â”œâ”€â”€ config.ts          # è¯»å–å·¥å…·é…ç½®
â”‚       â”œâ”€â”€ index.ts           # è¯»å–å·¥å…·å¯¼å‡º
â”‚       â””â”€â”€ src/
â”‚           â”œâ”€â”€ index.ts       # è¯»å–æ ¸å¿ƒå®ç°
â”‚           â””â”€â”€ types.ts       # è¯»å–ç±»å‹å®šä¹‰
â””â”€â”€ å¼€å‘æ—¥å¿—.md                 # å¼€å‘è®°å½•
```

### 2. Children åŠŸèƒ½ç‰¹æ®Šè¦æ±‚

### 2. Children åŠŸèƒ½ç‰¹æ®Šè¦æ±‚

#### 2.1 ä¸»é…ç½®æ–‡ä»¶è¦æ±‚
- å¿…é¡»ä½¿ç”¨ `defineToolSet` å‡½æ•°
- å¿…é¡»åŒ…å« `children` æ•°ç»„ï¼Œå¯¼å…¥æ‰€æœ‰å­å·¥å…·
- å·¥å…·é›†ç±»å‹è®¾ç½®ä¸º `ToolTypeEnum.search`ï¼ˆå› ä¸ºä¸»è¦åŠŸèƒ½æ˜¯æœç´¢ç›¸å…³ï¼‰

#### 2.2 å­å·¥å…·å¯¼å‡ºè¦æ±‚
- æ¯ä¸ªå­å·¥å…·å¿…é¡»ä½¿ç”¨ `exportTool` å‡½æ•°
- å¯¼å…¥è·¯å¾„å¿…é¡»æ˜¯ `'./src'` è€Œä¸æ˜¯ `'./src/index'`
- å¿…é¡»åŒ…å« `toolCb`, `InputType`, `OutputType`, `config` å››ä¸ªå¯¼å‡ºé¡¹

#### 2.3 å…±äº«æ¨¡å—è®¾è®¡
- API å®¢æˆ·ç«¯ç»Ÿä¸€ç®¡ç† Metaso API è°ƒç”¨
- é…ç½®ç®¡ç†å¼ºåˆ¶è¦æ±‚ API Keyï¼Œæé«˜å®‰å…¨æ€§
- ç±»å‹å®šä¹‰é‡‡ç”¨ Zod è¿›è¡Œè¿è¡Œæ—¶éªŒè¯
- å·¥å…·å‡½æ•°æä¾›é”™è¯¯å¤„ç†å’Œå“åº”æ ¼å¼åŒ–

## ğŸš¨ å…³é”®é”™è¯¯ä¿®å¤è®°å½•

### âš ï¸ é‡è¦ï¼šversionList æœªå®šä¹‰é”™è¯¯

**é”™è¯¯ç°è±¡**ï¼š
```
Cannot read properties of undefined (reading '0')
```

**é”™è¯¯åŸå› **ï¼š
1. åœ¨ `modules/tool/init.ts` çš„ `LoadToolsByFilename` å‡½æ•°ä¸­ï¼Œå­å·¥å…·å’Œå•ä¸ªå·¥å…·çš„ `versionList` å­—æ®µå¯èƒ½ä¸º `undefined`
2. `formatToolList` å‡½æ•°å°è¯•è®¿é—® `item.versionList` æ—¶ï¼Œå¦‚æœè¯¥å­—æ®µä¸º `undefined`ï¼Œä¼šå¯¼è‡´å‰ç«¯è®¿é—®æ•°ç»„å…ƒç´ æ—¶å‡ºé”™

**ä¿®å¤æ–¹æ³•**ï¼š
åœ¨ `modules/tool/init.ts` ä¸­ä¸ºæ‰€æœ‰å·¥å…·æ·»åŠ  `versionList` ä¿æŠ¤ï¼š

```typescript
// å­å·¥å…·ä¿®å¤ï¼ˆç¬¬65-77è¡Œï¼‰
for (const child of children) {
  const toolId = child.toolId!;
  tools.push({
    ...child,
    toolId,
    parentId: toolsetId,
    type: rootMod.type,
    courseUrl: rootMod.courseUrl,
    author: rootMod.author,
    icon,
    toolDirName: filename,
    // ğŸ”¥ å…³é”®ä¿®å¤ï¼šç¡®ä¿ versionList å­˜åœ¨
    versionList: child.versionList || []
  });
}

// å•ä¸ªå·¥å…·ä¿®å¤ï¼ˆç¬¬83-92è¡Œï¼‰
tools.push({
  ...tool,
  type: tool.type || ToolTypeEnum.tools,
  icon: tool.icon || defaultIcon,
  toolId: tool.toolId || filename,
  toolDirName: filename,
  // ğŸ”¥ å…³é”®ä¿®å¤ï¼šç¡®ä¿ versionList å­˜åœ¨
  versionList: tool.versionList || []
});
```

**é¢„é˜²æªæ–½**ï¼š
1. æ‰€æœ‰å·¥å…·é…ç½®å¿…é¡»åŒ…å«æœ‰æ•ˆçš„ `versionList` æ•°ç»„
2. åœ¨å·¥å…·åŠ è½½é€»è¾‘ä¸­å§‹ç»ˆæä¾›é»˜è®¤çš„ç©ºæ•°ç»„ä½œä¸ºåå¤‡
3. å®šæœŸæ£€æŸ¥ `formatToolList` å‡½æ•°çš„è¾“å…¥æ•°æ®å®Œæ•´æ€§

### âš ï¸ å¼‚æ­¥åˆå§‹åŒ–é”™è¯¯

**é”™è¯¯ç°è±¡**ï¼š
å·¥å…·å¯èƒ½æœªå®Œå…¨åŠ è½½å°±å¼€å§‹å¤„ç†è¯·æ±‚

**ä¿®å¤æ–¹æ³•**ï¼š
åœ¨ `src/index.ts` ä¸­ä¸º `initTool()` æ·»åŠ  `await`ï¼š

```typescript
// ä¿®å¤å‰
initTool();

// ä¿®å¤å
try {
  await initTool();
} catch (error) {
  console.error('Failed to initialize tools:', error);
  process.exit(1);
}
```

## ğŸ”§ è¯¦ç»†è®¾è®¡

### 1. å…±äº«æ¨¡å—è®¾è®¡

#### 1.1 API å®¢æˆ·ç«¯ (shared/api.ts)
```typescript
// Metaso API å®¢æˆ·ç«¯è®¾è®¡
export class MetasoClient {
  private apiKey: string;
  private baseURL: string = 'https://metaso.cn/api/v1';
  
  constructor(apiKey: string) {
    if (!apiKey) {
      throw new Error('API Key is required');
    }
    this.apiKey = apiKey;
  }
  
  // æœç´¢æ¥å£
  async search(params: SearchParams): Promise<SearchResponse>
  
  // é—®ç­”æ¥å£  
  async ask(params: AskParams): Promise<AskResponse>
  
  // ç½‘é¡µè¯»å–æ¥å£
  async reader(params: ReaderParams): Promise<ReaderResponse>
}
```

#### 1.2 é…ç½®ç®¡ç† (shared/config.ts)
```typescript
// å¼ºåˆ¶è¦æ±‚ API Keyï¼Œæé«˜å®‰å…¨æ€§
export function getMetasoConfig(apiKey: string): MetasoConfig {
  if (!apiKey) {
    throw new Error('Metaso API Key is required');
  }
  
  return {
    apiKey,
    baseURL: 'https://metaso.cn/api/v1',
    timeout: 30000
  };
}

// é…ç½®éªŒè¯
export function validateConfig(config: MetasoConfig): ValidationResult {
  if (!config.apiKey) {
    return { valid: false, error: 'API Key is required' };
  }
  return { valid: true };
}
```

#### 1.3 ç±»å‹å®šä¹‰ (shared/types.ts)
```typescript
// ä½¿ç”¨ Zod è¿›è¡Œç±»å‹éªŒè¯
export const MetasoConfigSchema = z.object({
  apiKey: z.string().min(1, 'API Key cannot be empty'),
  baseURL: z.string().url(),
  timeout: z.number().positive()
});

// é€šç”¨å“åº”æ ¼å¼
export const BaseResponseSchema = z.object({
  success: z.boolean(),
  data: z.any().optional(),
  message: z.string(),
  error: z.string().optional()
});
```

### 2. å­å·¥å…·è®¾è®¡

#### 2.1 æœç´¢å·¥å…· (children/search)

**åŠŸèƒ½æè¿°**: é€šè¿‡å…³é”®è¯æœç´¢ç½‘é¡µå†…å®¹ï¼Œæ”¯æŒæ‘˜è¦ç”Ÿæˆå’Œç»“æœæ•°é‡æ§åˆ¶

**è¾“å…¥å‚æ•°**:
- `apiKey` (secret, required): Metaso API å¯†é’¥
- `query` (string, required): æœç´¢å…³é”®è¯
  - **å·¥ä½œæµé›†æˆ**: æ”¯æŒ `reference` å’Œ `input` ä¸¤ç§è¾“å…¥æ–¹å¼
  - **reference**: å¯æ¥æ”¶å·¥ä½œæµä¸Šä¸€èŠ‚ç‚¹æˆ–èµ·å§‹èŠ‚ç‚¹çš„è¾“å‡ºæ•°æ®
  - **input**: æ”¯æŒç›´æ¥æ‰‹åŠ¨è¾“å…¥æœç´¢å…³é”®è¯
- `scope` (select, optional): æœç´¢èŒƒå›´ï¼Œé»˜è®¤ "webpage"
- `includeSummary` (boolean, optional): æ˜¯å¦åŒ…å«æ‘˜è¦ï¼Œé»˜è®¤ false
- `size` (number, optional): ç»“æœæ•°é‡ï¼Œé»˜è®¤ 10ï¼ŒèŒƒå›´ 1-20

**è¾“å‡ºç»“æœ**:
- `success` (boolean): æ‰§è¡ŒçŠ¶æ€
- `results` (array): æœç´¢ç»“æœåˆ—è¡¨
- `summary` (string, optional): æœç´¢æ‘˜è¦
- `message` (string): ç»“æœæ¶ˆæ¯

#### 2.2 é—®ç­”å·¥å…· (children/ask)

**åŠŸèƒ½æè¿°**: åŸºäºç½‘é¡µå†…å®¹çš„æ™ºèƒ½é—®ç­”æœåŠ¡

**è¾“å…¥å‚æ•°**:
- `apiKey` (secret, required): Metaso API å¯†é’¥
- `question` (string, required): é—®é¢˜å†…å®¹
  - **å·¥ä½œæµé›†æˆ**: æ”¯æŒ `reference` å’Œ `input` ä¸¤ç§è¾“å…¥æ–¹å¼
  - **reference**: å¯æ¥æ”¶å·¥ä½œæµä¸Šä¸€èŠ‚ç‚¹æˆ–èµ·å§‹èŠ‚ç‚¹çš„è¾“å‡ºæ•°æ®
  - **input**: æ”¯æŒç›´æ¥æ‰‹åŠ¨è¾“å…¥é—®é¢˜å†…å®¹
- `scope` (select, optional): æœç´¢èŒƒå›´ï¼Œé»˜è®¤ "webpage"

**è¾“å‡ºç»“æœ**:
- `success` (boolean): æ‰§è¡ŒçŠ¶æ€
- `answer` (string): é—®ç­”ç»“æœ
- `sources` (array, optional): å‚è€ƒæ¥æº
- `message` (string): ç»“æœæ¶ˆæ¯

#### 2.3 ç½‘é¡µè¯»å–å·¥å…· (children/reader)

**åŠŸèƒ½æè¿°**: è¯»å–æŒ‡å®šURLçš„ç½‘é¡µå†…å®¹å¹¶è¿›è¡Œè§£æ

**è¾“å…¥å‚æ•°**:
- `apiKey` (secret, required): Metaso API å¯†é’¥
- `url` (string, required): ç›®æ ‡ç½‘é¡µURL
  - **å·¥ä½œæµé›†æˆ**: æ”¯æŒ `reference` å’Œ `input` ä¸¤ç§è¾“å…¥æ–¹å¼
  - **reference**: å¯æ¥æ”¶å·¥ä½œæµä¸Šä¸€èŠ‚ç‚¹æˆ–èµ·å§‹èŠ‚ç‚¹çš„è¾“å‡ºæ•°æ®
  - **input**: æ”¯æŒç›´æ¥æ‰‹åŠ¨è¾“å…¥ç½‘é¡µURL
- `format` (select, optional): è¾“å‡ºæ ¼å¼ï¼Œé»˜è®¤ "text"

**è¾“å‡ºç»“æœ**:
- `success` (boolean): æ‰§è¡ŒçŠ¶æ€
- `content` (string): ç½‘é¡µå†…å®¹
- `title` (string, optional): ç½‘é¡µæ ‡é¢˜
- `message` (string): ç»“æœæ¶ˆæ¯

### 3. å·¥ä½œæµé›†æˆé…ç½®

#### 3.1 è¾“å…¥å‚æ•°é…ç½®æ ‡å‡†
æ‰€æœ‰ä¸»è¦è¾“å…¥å‚æ•°ï¼ˆqueryã€questionã€urlï¼‰éƒ½å¿…é¡»æ”¯æŒå·¥ä½œæµé›†æˆï¼š

```typescript
{
  key: 'query',  // å‚æ•°å
  label: 'æœç´¢å…³é”®è¯',
  description: 'è¦æœç´¢çš„å…³é”®è¯æˆ–æŸ¥è¯¢è¯­å¥',
  toolDescription: 'æœç´¢å…³é”®è¯',
  required: true,
  valueType: WorkflowIOValueTypeEnum.string,
  renderTypeList: [
    FlowNodeInputTypeEnum.reference,  // æ”¯æŒå¼•ç”¨å…¶ä»–èŠ‚ç‚¹è¾“å‡º
    FlowNodeInputTypeEnum.input       // æ”¯æŒæ‰‹åŠ¨è¾“å…¥
  ]
}
```

#### 3.2 å·¥ä½œæµåµŒå…¥åœºæ™¯ç¤ºä¾‹

**åœºæ™¯1: æ™ºèƒ½æœç´¢é“¾**
```
ç”¨æˆ·è¾“å…¥ â†’ å…³é”®è¯æå– â†’ Metasoæœç´¢ â†’ ç»“æœæ•´ç† â†’ å›å¤ç”Ÿæˆ
```

**åœºæ™¯2: é—®ç­”å¢å¼º**
```
ç”¨æˆ·é—®é¢˜ â†’ é—®é¢˜åˆ†æ â†’ Metasoé—®ç­” â†’ ç­”æ¡ˆéªŒè¯ â†’ æœ€ç»ˆå›å¤
```

**åœºæ™¯3: ç½‘é¡µå†…å®¹åˆ†æ**
```
URLè¾“å…¥ â†’ å†…å®¹æå–(Metaso Reader) â†’ å†…å®¹åˆ†æ â†’ æ‘˜è¦ç”Ÿæˆ
```

#### 3.3 å‚æ•°ä¼ é€’æœºåˆ¶
- **referenceæ¨¡å¼**: è‡ªåŠ¨æ¥æ”¶ä¸Šä¸€èŠ‚ç‚¹çš„æŒ‡å®šè¾“å‡ºå­—æ®µ
- **å…¨å±€å˜é‡**: æ”¯æŒé€šè¿‡FastGPTå…¨å±€å˜é‡ä¼ é€’æ•°æ®
- **å¤šèŠ‚ç‚¹ç»„åˆ**: æ”¯æŒå¤šä¸ªMetasoå­å·¥å…·ä¸²è”ä½¿ç”¨

## ğŸš¨ å…³é”®æŠ€æœ¯è¦ç‚¹

### 1. Children æ¶æ„è¦æ±‚

#### 1.1 ä¸»é…ç½®æ–‡ä»¶ (config.ts)
```typescript
import { defineToolSet } from '@tool/type';
import { ToolTypeEnum } from '@tool/type/tool';
import searchTool from './children/search';
import askTool from './children/ask';
import readerTool from './children/reader';

export default defineToolSet({
  name: {
    'zh-CN': 'Metaso å·¥å…·é›†',
    'en-US': 'Metaso Tools'
  },
  description: {
    'zh-CN': 'åŸºäº Metaso API çš„æœç´¢ã€é—®ç­”å’Œç½‘é¡µè¯»å–å·¥å…·é›†',
    'en-US': 'Search, Q&A and web reading tools based on Metaso API'
  },
  type: ToolTypeEnum.search,
  icon: '/imgs/tools/metaso.svg',
  children: [searchTool, askTool, readerTool]  // å¿…é¡»åŒ…å«æ‰€æœ‰å­å·¥å…·
});
```

#### 1.2 å­å·¥å…·å¯¼å‡º (children/*/index.ts)
```typescript
import config from './config';
import { InputType, OutputType, tool as toolCb } from './src';
import { exportTool } from '@tool/utils/tool';

export default exportTool({
  toolCb,
  InputType,
  OutputType,
  config
});
```

### 2. ç»Ÿä¸€çš„è¾“å…¥é…ç½®æ¨¡å¼

#### 2.1 API Key é…ç½®
```typescript
// æ‰€æœ‰å­å·¥å…·éƒ½å¿…é¡»åŒ…å«çš„ API Key é…ç½®
{
  key: SystemInputKeyEnum.systemInputConfig,
  label: '',
  inputList: [
    {
      key: 'apiKey',
      label: 'Metaso API Key',
      description: 'Metaso å¹³å°çš„ API å¯†é’¥',
      required: true,
      inputType: 'secret'
    }
  ],
  renderTypeList: [FlowNodeInputTypeEnum.hidden],
  valueType: WorkflowIOValueTypeEnum.object
}
```

#### 2.2 ä¸šåŠ¡å‚æ•°é…ç½®
```typescript
// ç»Ÿä¸€çš„å‚æ•°å‘½åè§„èŒƒï¼ˆé©¼å³°å‘½åï¼‰
{
  key: 'query',  // ä¸æ˜¯ 'q'
  key: 'includeSummary',  // ä¸æ˜¯ 'include_summary'
  key: 'resultSize'  // ä¸æ˜¯ 'size'
}
```

### 3. é”™è¯¯å¤„ç†æœºåˆ¶

#### 3.1 åˆ†å±‚é”™è¯¯å¤„ç†
```typescript
function handleError(error: any): OutputType {
  console.error('[Metaso] æ‰§è¡Œå¤±è´¥:', error);
  
  let errorMessage = 'æ“ä½œå¤±è´¥';
  
  if (error instanceof Error) {
    if (error.message.includes('invalid credential')) {
      errorMessage = 'API å¯†é’¥æ— æ•ˆï¼Œè¯·æ£€æŸ¥æ‚¨çš„ Metaso API Key';
    } else if (error.message.includes('timeout')) {
      errorMessage = 'è¯·æ±‚è¶…æ—¶ï¼Œè¯·ç¨åé‡è¯•';
    } else if (error.message.includes('404')) {
      errorMessage = 'èµ„æºä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥å‚æ•°';
    } else {
      errorMessage = `æ“ä½œå¤±è´¥: ${error.message}`;
    }
  }
  
  return createErrorOutput(errorMessage);
}
```

### 4. å¼€å‘é¡ºåºè¦æ±‚

#### 4.1 å•ä¸€åŠŸèƒ½ä¼˜å…ˆåŸåˆ™
1. **ç¬¬ä¸€é˜¶æ®µ**: å¼€å‘æœç´¢å·¥å…·ï¼ˆæœ€ç®€å•çš„åŠŸèƒ½ï¼‰
2. **éªŒè¯é˜¶æ®µ**: ç¡®ä¿æœç´¢å·¥å…·å®Œå…¨æ­£ç¡®ï¼Œæ„å»ºæˆåŠŸ
3. **ç¬¬äºŒé˜¶æ®µ**: åŸºäºæœç´¢å·¥å…·æ¨¡æ¿å¼€å‘é—®ç­”å·¥å…·
4. **ç¬¬ä¸‰é˜¶æ®µ**: å¼€å‘ç½‘é¡µè¯»å–å·¥å…·
5. **é›†æˆé˜¶æ®µ**: å®Œå–„å…±äº«æ¨¡å—å’Œæ•´ä½“æµ‹è¯•

#### 4.2 æ„å»ºéªŒè¯è¦æ±‚
æ¯ä¸ªé˜¶æ®µéƒ½å¿…é¡»é€šè¿‡ä»¥ä¸‹éªŒè¯ï¼š
- `npm run build` æ„å»ºæˆåŠŸ
- TypeScript ç±»å‹æ£€æŸ¥é€šè¿‡
- åŠŸèƒ½æµ‹è¯•éªŒè¯
- FastGPT ç•Œé¢æ­£å¸¸æ˜¾ç¤º

## ğŸ“‹ å¼€å‘æ£€æŸ¥æ¸…å•

### 1. é¡¹ç›®ç»“æ„æ£€æŸ¥
- [ ] åˆ›å»ºå®Œæ•´çš„ç›®å½•ç»“æ„
- [ ] æ·»åŠ  logo.svg å›¾æ ‡æ–‡ä»¶
- [ ] åˆ›å»º package.json é…ç½®

### 2. å…±äº«æ¨¡å—æ£€æŸ¥
- [ ] API å®¢æˆ·ç«¯å®ç°å®Œæ•´
- [ ] é…ç½®ç®¡ç†å¼ºåˆ¶è¦æ±‚ API Key
- [ ] ç±»å‹å®šä¹‰ä½¿ç”¨ Zod éªŒè¯
- [ ] å·¥å…·å‡½æ•°æä¾›å®Œæ•´é”™è¯¯å¤„ç†

### 3. å­å·¥å…·æ£€æŸ¥
- [ ] æ¯ä¸ªå­å·¥å…·ä½¿ç”¨ exportTool å‡½æ•°
- [ ] è¾“å…¥é…ç½®åŒ…å« API Key å’Œä¸šåŠ¡å‚æ•°
- [ ] è¾“å‡ºæ ¼å¼ç»Ÿä¸€ä¸”å®Œæ•´
- [ ] é”™è¯¯å¤„ç†æœºåˆ¶å®Œå–„

### 4. Children æ¶æ„æ£€æŸ¥
- [ ] ä¸»é…ç½®æ–‡ä»¶å¯¼å…¥æ‰€æœ‰å­å·¥å…·
- [ ] children æ•°ç»„åŒ…å«æ‰€æœ‰å­å·¥å…·
- [ ] å­å·¥å…·å¯¼å‡ºç»“æ„æ­£ç¡®
- [ ] å¯¼å…¥è·¯å¾„ä½¿ç”¨ './src' æ ¼å¼

### 5. æ„å»ºéªŒè¯æ£€æŸ¥
- [ ] è¿è¡Œ `npm run build` æ— é”™è¯¯
- [ ] ç”Ÿæˆçš„æ–‡ä»¶å­˜åœ¨äº dist/tools/ ç›®å½•
- [ ] FastGPT ä¸­å¯ä»¥æ­£å¸¸æ˜¾ç¤ºå’Œä½¿ç”¨

## ğŸ¯ é¢„æœŸæˆæœ

### 1. åŠŸèƒ½å®Œæ•´æ€§
- ä¸‰ä¸ªå­å·¥å…·åŠŸèƒ½å®Œæ•´ä¸”ç‹¬ç«‹
- API è°ƒç”¨ç¨³å®šå¯é 
- é”™è¯¯å¤„ç†æœºåˆ¶å®Œå–„

### 2. ä»£ç è´¨é‡
- TypeScript ç±»å‹å®‰å…¨
- ä»£ç ç»“æ„æ¸…æ™°æ¨¡å—åŒ–
- ç¬¦åˆ FastGPT å¼€å‘è§„èŒƒ

### 3. ç”¨æˆ·ä½“éªŒ
- é…ç½®ç®€å•ï¼ˆåªéœ€ API Keyï¼‰
- åŠŸèƒ½ç›´è§‚æ˜“ç”¨
- é”™è¯¯æç¤ºæ¸…æ™°å‹å¥½

### 4. å¯ç»´æŠ¤æ€§
- å…±äº«æ¨¡å—å¤ç”¨æ€§å¼º
- å­å·¥å…·ç‹¬ç«‹å¯æ‰©å±•
- æ–‡æ¡£å®Œæ•´ä¾¿äºç»´æŠ¤

## ğŸ“ åç»­æ‰©å±•è®¡åˆ’

### 1. åŠŸèƒ½æ‰©å±•
- æ”¯æŒæ›´å¤šæœç´¢èŒƒå›´é€‰é¡¹
- æ·»åŠ ç»“æœç¼“å­˜æœºåˆ¶
- æ”¯æŒæ‰¹é‡å¤„ç†åŠŸèƒ½

### 2. æ€§èƒ½ä¼˜åŒ–
- å®ç°è¯·æ±‚é‡è¯•æœºåˆ¶
- æ·»åŠ å“åº”æ—¶é—´ç›‘æ§
- ä¼˜åŒ–å¤§æ–‡ä»¶å¤„ç†

### 3. ç”¨æˆ·ä½“éªŒ
- æ·»åŠ è¿›åº¦æç¤º
- æ”¯æŒç»“æœé¢„è§ˆ
- æä¾›ä½¿ç”¨ç¤ºä¾‹

è¿™ä¸ªè®¾è®¡æ–‡æ¡£ä¸º Metaso æ’ä»¶çš„å¼€å‘æä¾›äº†å®Œæ•´çš„æŠ€æœ¯æ–¹æ¡ˆå’Œå®æ–½æŒ‡å—ï¼Œç‰¹åˆ«å…³æ³¨äº† Children ToolSet æ¶æ„çš„ç‰¹æ®Šè¦æ±‚å’Œæœ€ä½³å®è·µã€‚

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹ï¼šæ„å»ºç¼“å­˜é—®é¢˜

### 1. æ„å»ºç¼“å­˜çš„å½±å“

#### 1.1 é—®é¢˜ç°è±¡
- **ç•Œé¢æ˜¾ç¤ºå¼‚å¸¸**ï¼šå¯èƒ½å‡ºç°ç©ºç™½æŒ‰é’®æˆ–é‡å¤æ˜¾ç¤º
- **é…ç½®ä¸ç”Ÿæ•ˆ**ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶åç•Œé¢æ²¡æœ‰å˜åŒ–
- **åŠŸèƒ½å¼‚å¸¸**ï¼šå·¥å…·åŠŸèƒ½ä¸é¢„æœŸä¸ç¬¦

#### 1.2 æ ¹æœ¬åŸå› 
- **ç¼“å­˜æ®‹ç•™**ï¼šæ—§çš„æ„å»ºç¼“å­˜ä¸­ä¿ç•™äº†è¿‡æ—¶çš„é…ç½®ä¿¡æ¯
- **å¢é‡æ„å»º**ï¼šéƒ¨åˆ†æ„å»ºå·¥å…·å¯èƒ½åªæ›´æ–°å˜åŒ–çš„æ–‡ä»¶ï¼Œå¿½ç•¥ä¾èµ–å…³ç³»
- **é…ç½®ä¼ æ’­**ï¼šé…ç½®ä¿®æ”¹éœ€è¦é€šè¿‡å®Œæ•´çš„æ„å»ºè¿‡ç¨‹æ‰èƒ½ä¼ æ’­åˆ°æœ€ç»ˆäº§ç‰©

### 2. å¼ºåˆ¶æ€§æ„å»ºè¦æ±‚

#### 2.1 é…ç½®ä¿®æ”¹åå¿…é¡»é‡æ–°æ„å»º
```bash
# ä»»ä½•é…ç½®æ–‡ä»¶ä¿®æ”¹åéƒ½å¿…é¡»æ‰§è¡Œ
npm run build

# æˆ–è€…åœ¨å¼€å‘ç¯å¢ƒä¸­
bun run build
```

#### 2.2 å…³é”®ä¿®æ”¹åœºæ™¯
ä»¥ä¸‹ä¿®æ”¹**å¿…é¡»**ç«‹å³é‡æ–°æ„å»ºï¼š
- ä¿®æ”¹ä»»ä½• `config.ts` æ–‡ä»¶
- ä¿®æ”¹å­å·¥å…·çš„å¯¼å…¥å¯¼å‡ºç»“æ„
- ä¿®æ”¹å·¥å…·é›†çš„ `children` æ•°ç»„
- ä¿®æ”¹å›¾æ ‡é…ç½®æˆ–è·¯å¾„
- ä¿®æ”¹å·¥å…·åç§°æˆ–æè¿°

#### 2.3 æ„å»ºéªŒè¯
```bash
# 1. æ‰§è¡Œæ„å»º
npm run build

# 2. æ£€æŸ¥æ„å»ºæ—¥å¿—
# åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
# Building metaso...
# metaso build complete

# 3. éªŒè¯æ„å»ºäº§ç‰©
ls -la dist/tools/metaso/

# 4. æµ‹è¯•ç•Œé¢æ˜¾ç¤º
# åœ¨ FastGPT ä¸­æ£€æŸ¥å·¥å…·é›†æ˜¯å¦æ­£ç¡®æ˜¾ç¤º
```

### 3. å¸¸è§é”™è¯¯æ¨¡å¼åŠè§£å†³æ–¹æ¡ˆ

#### 3.1 ç©ºç™½æŒ‰é’®é—®é¢˜
**é”™è¯¯ç°è±¡**ï¼š
- ç•Œé¢æ˜¾ç¤ºé¢å¤–çš„ç©ºç™½æŒ‰é’®
- å·¥å…·æ•°é‡ä¸é…ç½®ä¸ç¬¦

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ç«‹å³é‡æ–°æ„å»º
npm run build

# å¦‚æœé—®é¢˜æŒç»­ï¼Œæ¸…é™¤ç¼“å­˜åé‡æ–°æ„å»º
rm -rf dist/
npm run build
```

#### 3.2 é…ç½®ä¸ç”Ÿæ•ˆé—®é¢˜
**é”™è¯¯ç°è±¡**ï¼š
- ä¿®æ”¹å·¥å…·åç§°åç•Œé¢æ²¡æœ‰å˜åŒ–
- ä¿®æ”¹å›¾æ ‡åä»æ˜¾ç¤ºæ—§å›¾æ ‡

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ç¡®ä¿å®Œæ•´é‡æ–°æ„å»º
npm run build

# æ£€æŸ¥æ„å»ºæ—¥å¿—ç¡®è®¤å·¥å…·è¢«é‡æ–°ç¼–è¯‘
```

#### 3.3 é‡å¤æ˜¾ç¤ºé—®é¢˜
**é”™è¯¯ç°è±¡**ï¼š
- åŒä¸€ä¸ªå·¥å…·æ˜¾ç¤ºå¤šæ¬¡
- å·¥å…·é›†å›¾æ ‡é‡å¤

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰é‡å¤å¯¼å…¥
grep -r "import.*metaso" .

# é‡æ–°æ„å»º
npm run build
```

### 4. æœ€ä½³å®è·µ

#### 4.1 å¼€å‘æµç¨‹
```bash
# æ ‡å‡†å¼€å‘æµç¨‹
# 1. ä¿®æ”¹é…ç½®æ–‡ä»¶
vim children/metasoSearch/src/config.ts

# 2. ç«‹å³æ„å»ºéªŒè¯
npm run build

# 3. æ£€æŸ¥æ„å»ºç»“æœ
# æŸ¥çœ‹æ„å»ºæ—¥å¿—ï¼Œç¡®è®¤æ— é”™è¯¯

# 4. æµ‹è¯•åŠŸèƒ½
# åœ¨ FastGPT ä¸­æµ‹è¯•å·¥å…·æ˜¯å¦æ­£å¸¸å·¥ä½œ

# 5. æäº¤ä»£ç 
git add .
git commit -m "ä¿®æ”¹å·¥å…·é…ç½®"
```

#### 4.2 è°ƒè¯•æŠ€å·§
```javascript
// ä½¿ç”¨è„šæœ¬éªŒè¯é…ç½®åŠ è½½
// debug-config.js
const config = require('./config.ts');
console.log('å·¥å…·é›†é…ç½®:', {
  name: config.default.name,
  childrenCount: config.default.children.length,
  children: config.default.children.map(c => c.name)
});
```

#### 4.3 é¢„é˜²æªæ–½
- **åŠæ—¶æ„å»º**ï¼šæ¯æ¬¡é…ç½®ä¿®æ”¹åç«‹å³æ„å»º
- **å®Œæ•´æµ‹è¯•**ï¼šæ„å»ºååœ¨ FastGPT ä¸­å®Œæ•´æµ‹è¯•åŠŸèƒ½
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šä½¿ç”¨ git è®°å½•æ¯æ¬¡ä¿®æ”¹ï¼Œä¾¿äºå›æ»š
- **æ–‡æ¡£è®°å½•**ï¼šåœ¨å¼€å‘æ—¥å¿—ä¸­è®°å½•é‡è¦çš„é…ç½®ä¿®æ”¹

### 5. æ•…éšœæ’é™¤æŒ‡å—

#### 5.1 å¿«é€Ÿè¯Šæ–­
```bash
# 1. æ£€æŸ¥æ„å»ºçŠ¶æ€
npm run build 2>&1 | grep -E "(error|warning|complete)"

# 2. æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•
node -c config.ts

# 3. æ£€æŸ¥å­å·¥å…·å¯¼å…¥
node -e "console.log(require('./config.ts').default.children.length)"

# 4. æ£€æŸ¥æ„å»ºäº§ç‰©
ls -la dist/tools/metaso/
```

#### 5.2 å®Œå…¨é‡ç½®
å¦‚æœé—®é¢˜æŒç»­å­˜åœ¨ï¼š
```bash
# 1. æ¸…é™¤æ‰€æœ‰æ„å»ºç¼“å­˜
rm -rf dist/
rm -rf node_modules/.cache/
rm -rf .next/

# 2. é‡æ–°å®‰è£…ä¾èµ–
npm install

# 3. å®Œå…¨é‡æ–°æ„å»º
npm run build

# 4. é‡å¯å¼€å‘æœåŠ¡å™¨
npm run dev
```

### 6. å…³é”®è¦ç‚¹æ€»ç»“

1. **é…ç½®ä¿®æ”¹åå¿…é¡»é‡æ–°æ„å»º** - è¿™æ˜¯æœ€é‡è¦çš„è§„åˆ™
2. **æ„å»ºè¿‡ç¨‹æ˜¯é…ç½®ç”Ÿæ•ˆçš„å”¯ä¸€é€”å¾„** - ä¸æ„å»ºå°±ä¸ä¼šç”Ÿæ•ˆ
3. **ç¼“å­˜é—®é¢˜å¯èƒ½å¯¼è‡´çœ‹ä¼¼æ­£ç¡®çš„é…ç½®æ— æ³•æ­£ç¡®æ˜¾ç¤º** - é‡æ–°æ„å»ºæ˜¯è§£å†³æ–¹æ¡ˆ
4. **åŠæ—¶éªŒè¯æ˜¯æœ€ä½³å®è·µ** - ä¿®æ”¹åç«‹å³æ„å»ºå’Œæµ‹è¯•
5. **å®Œæ•´çš„æ„å»ºæ—¥å¿—æ˜¯è°ƒè¯•çš„é‡è¦ä¿¡æ¯** - å…³æ³¨æ„å»ºè¿‡ç¨‹çš„è¾“å‡º

é€šè¿‡éµå¾ªè¿™äº›æ„å»ºè¦æ±‚å’Œæœ€ä½³å®è·µï¼Œå¯ä»¥æœ‰æ•ˆé¿å…å› æ„å»ºç¼“å­˜å¯¼è‡´çš„å„ç§æ˜¾ç¤ºå’ŒåŠŸèƒ½é—®é¢˜ã€‚